<!-- Header -->
<header class="bg-indigo-900 text-white shadow-xl sticky top-0 z-40">
    <div class="container mx-auto px-4">
        <!-- Top Bar -->
        <div class="flex justify-between items-center py-3 border-b border-indigo-800/50">
            <h1 class="text-xl font-bold flex items-center gap-3">
                <i class="fas fa-university text-yellow-400"></i>
                <span class="hidden sm:inline">مدير المدرسة الذكي</span>
                
                <!-- Cloud Badge -->
                @if (store.cloudStatus() === 'connected') {
                    <span class="text-[10px] bg-green-500/20 text-green-300 px-2 py-0.5 rounded-full border border-green-500/30 flex items-center gap-1">
                        <i class="fas fa-circle text-[6px] animate-pulse"></i> متصل
                    </span>
                } @else if (store.cloudStatus() === 'saving') {
                    <span class="text-[10px] bg-amber-500/20 text-amber-300 px-2 py-0.5 rounded-full border border-amber-500/30">
                        جاري الحفظ...
                    </span>
                } @else {
                    <span class="text-[10px] bg-red-500/20 text-red-300 px-2 py-0.5 rounded-full border border-red-500/30">
                        غير متصل
                    </span>
                }
            </h1>

            <div class="flex gap-3 items-center">
                <div class="bg-black/20 px-3 py-1 rounded-lg border border-white/10 backdrop-blur-sm flex items-center gap-2">
                    <i class="fas fa-clock text-indigo-300 text-xs"></i>
                    <span class="font-mono font-bold text-green-400 dir-ltr">
                        {{ store.currentTime() | date:'HH:mm:ss' }}
                    </span>
                </div>
                <button (click)="store.addSimulationHour()" class="text-xs bg-white/10 hover:bg-white/20 p-2 rounded transition text-indigo-200 hover:text-white" title="تقديم ساعة">
                    <i class="fas fa-forward"></i>
                </button>
            </div>
        </div>
        
        <!-- Navigation -->
        <nav class="flex gap-1 overflow-x-auto pt-2 pb-0 scrollbar-hide">
            <button 
                (click)="setView('now')" 
                [class]="currentView() === 'now' ? 'bg-indigo-800 text-yellow-400 border-b-2 border-yellow-400' : 'text-indigo-200 hover:text-white hover:bg-indigo-800/50'"
                class="px-4 py-3 rounded-t-lg transition-all flex items-center gap-2 whitespace-nowrap">
                <i class="fas fa-chalkboard"></i> الحصص الحالية
            </button>
            
            <button 
                (click)="setView('teachers')" 
                [class]="currentView() === 'teachers' ? 'bg-indigo-800 text-yellow-400 border-b-2 border-yellow-400' : 'text-indigo-200 hover:text-white hover:bg-indigo-800/50'"
                class="px-4 py-3 rounded-t-lg transition-all flex items-center gap-2 whitespace-nowrap">
                <i class="fas fa-users-cog"></i> المعلمون
            </button>
            
            <button 
                (click)="setView('reports')" 
                [class]="currentView() === 'reports' ? 'bg-indigo-800 text-yellow-400 border-b-2 border-yellow-400' : 'text-indigo-200 hover:text-white hover:bg-indigo-800/50'"
                class="px-4 py-3 rounded-t-lg transition-all flex items-center gap-2 whitespace-nowrap">
                <i class="fas fa-file-invoice"></i> التقارير
            </button>

            <div class="mr-auto self-center pb-2">
                <button (click)="showSettings.set(true)" class="text-sm bg-white/10 hover:bg-white/20 text-indigo-100 hover:text-white px-3 py-1.5 rounded-lg font-bold transition flex items-center gap-2">
                    <i class="fas fa-cog"></i> 
                    <span class="hidden md:inline">الإعدادات</span>
                </button>
            </div>
        </nav>
    </div>
</header>

<!-- Main Content -->
<main class="container mx-auto p-4 md:p-6 pb-20">
    @switch (currentView()) {
        @case ('now') {
            <app-current-classes (onAction)="openModal($event)" />
        }
        @case ('teachers') {
            <app-teacher-manager (onAction)="openModal($event)" />
        }
        @case ('reports') {
            <app-reports />
        }
    }
</main>

<!-- Modals -->
<app-action-modal 
    [teacher]="selectedTeacher()" 
    [className]="selectedClassName()"
    (close)="closeModal()" 
/>

@if (showSettings()) {
    <app-settings-modal (close)="showSettings.set(false)" />
}
