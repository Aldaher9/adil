<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ููุตุฉ ุงููุงุฆุฏ - ูุธุงู ุงูุฅุฏุงุฑุฉ ุงููุชูุงูู</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div id="login-screen">
        <div class="login-box">
            <h1>ููุตุฉ ุงููุงุฆุฏ โก</h1>
            <p style="color:#64748b; margin-bottom:20px;">ูุธุงู ุงูุฅุฏุงุฑุฉ ุงููุฏุฑุณูุฉ ุงูุฐูู</p>
            <button id="loginBtn" onclick="handleGoogleLogin()" class="google-btn">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" width="20" alt="Google">
                <span>ุชุณุฌูู ุงูุฏุฎูู ุนุจุฑ ุฌูุฌู</span>
            </button>
        </div>
    </div>

    <div class="header" id="mainHeader">
        <div class="user-welcome" id="welcomeMsg">๐ค ุฌุงุฑู ุงูุชุญููู...</div>
        <div class="header-top">
            <h1>ููุตุฉ ุงููุงุฆุฏ โก</h1>
            <div class="header-actions">
                <button class="header-btn" onclick="openModal('settingsModal')">โ๏ธ ุถุจุท</button>
                <button class="header-btn logout-btn" onclick="handleLogout()">๐ช ุฎุฑูุฌ</button>
            </div>
        </div>
    </div>

    <div id="main-content">
        
        <div id="view-dashboard" class="container active">
            <div class="status-card">
                <div>
                    <div id="dashDate" style="font-size:0.9rem; color:#64748b">--:--</div>
                    <div id="dashPeriod" style="font-weight:800; color: var(--primary); font-size:1.1rem;">ุฌุงุฑู ุงููุฒุงููุฉ..</div>
                </div>
                <div id="simBadge" style="display:none;" class="badge-sim">ูุถุน ุงููุญุงูุงุฉ</div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="statTeachers">0</div>
                    <div class="stat-label">ุงููุนูููู</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statClasses">0</div>
                    <div class="stat-label">ุงููุตูู</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statVisits">0</div>
                    <div class="stat-label">ุฒูุงุฑุฉ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statTasks">0</div>
                    <div class="stat-label">ููุงู</div>
                </div>
            </div>
        </div>

        <div id="view-schedule" class="container">
            <h3>๐ ุฌุฏูู ุงูุญุตุต ุงููููู</h3>
            <div id="lessons-list"></div>
        </div>

        <div id="view-staff" class="container">
            <input type="text" id="searchInput" placeholder="๐ ุงุจุญุซ ุนู ูุนูู..." onkeyup="filterStaff()" class="form-control" style="margin-bottom:15px;">
            <div id="staff-list"></div>
        </div>

        <div id="view-visits" class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="margin:0;">๐๏ธ ุงูุณุฌู ุงูุฅุดุฑุงูู</h3>
                <div style="display:flex; gap:5px;">
                    <button onclick="printFullReport()" class="action-btn" style="background:#475569; width:auto; font-size:12px;">๐จ๏ธ ุทุจุงุนุฉ</button>
                    <button onclick="openVisitModal()" class="action-btn" style="background:var(--primary); width:auto; font-size:12px;">+ ุฌุฏูุฏ</button>
                </div>
            </div>
            <div id="visits-list"></div>
        </div>

        <div id="view-agenda" class="container">
            <h3>๐ ุงูููุงู ุงูููููุฉ</h3>
            <div style="display:flex; gap:10px; margin-bottom:20px;">
                <input type="text" id="taskInput" class="form-control" placeholder="ูููุฉ ุฌุฏูุฏุฉ...">
                <button onclick="addTask()" class="action-btn" style="width:80px; margin-top:0;">ุฅุถุงูุฉ</button>
            </div>
            <div id="tasks-list"></div>
        </div>

    </div>

    <div class="bottom-nav" id="mainNav">
        <button class="nav-item active" onclick="switchTab('view-dashboard', this)"><span>๐</span>ุงูุฑุฆูุณูุฉ</button>
        <button class="nav-item" onclick="switchTab('view-schedule', this)"><span>๐</span>ุงูุญุตุต</button>
        <button class="nav-item" onclick="switchTab('view-staff', this)"><span>๐ฅ</span>ุงููุนูููู</button>
        <button class="nav-item" onclick="switchTab('view-visits', this)"><span>๐๏ธ</span>ุงูุฒูุงุฑุงุช</button>
        <button class="nav-item" onclick="switchTab('view-agenda', this)"><span>๐</span>ุงูููุงู</button>
    </div>

    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <h3>โ๏ธ ุฅุนุฏุงุฏุงุช ุงููุธุงู</h3>
            
            <div class="form-group">
                <label>1. ููู ุงูุฌุฏูู ุงููุฏุฑุณู (XML)</label>
                <input type="file" accept=".xml" onchange="handleXML(this)" class="form-control">
            </div>

            <div class="form-group">
                <label>2. ุจูุงูุงุช ุงููุนูููู (Excel)</label>
                <div class="grid-2">
                    <button onclick="document.getElementById('excelFile').click()" class="action-btn" style="background:#3b82f6;">ุงุณุชูุฑุงุฏ ๐ค</button>
                    <button onclick="exportToExcel()" class="action-btn" style="background:#10b981;">ุชุตุฏูุฑ ๐ฅ</button>
                    <input type="file" id="excelFile" style="display:none" onchange="importFromExcel(this)" accept=".xlsx, .xls">
                </div>
            </div>

            <div class="form-group">
                <label>3. ุงุณุชูุฑุงุฏ ุงูุฒูุงุฑุงุช (JSON)</label>
                <input type="file" accept=".json" onchange="importVisitsJSON(this)" class="form-control">
                <small style="color:#64748b">ูุฌุจ ุฃู ูููู ุงูููู ุจุตูุบุฉ JSON ุตุญูุญุฉ.</small>
            </div>

            <hr style="margin: 15px 0; border-color:#eee;">

            <div class="form-group">
                <label>ุงูุชุญูู ุจุงูููุช (ูููุญุงูุงุฉ)</label>
                <div class="grid-2">
                    <button onclick="doSim()" class="action-btn" style="background:#f59e0b;">ุชุดุบูู ุงููุญุงูุงุฉ ๐ฒ</button>
                    <button onclick="resetTime()" class="action-btn" style="background:#64748b;">ุนูุฏุฉ ููููุช ุงููุนูู ๐</button>
                </div>
            </div>

            <button onclick="closeModal('settingsModal')" class="action-btn" style="background:#f1f5f9; color:#333; margin-top:20px;">ุฅุบูุงู</button>
        </div>
    </div>

    <div id="visitModal" class="modal">
        <div class="modal-content">
            <h3>ุชุณุฌูู ุฒูุงุฑุฉ ุฌุฏูุฏุฉ</h3>
            <div class="form-group">
                <label>ุงููุนูู</label>
                <select id="visitTeacher" class="form-control"></select>
            </div>
            <div class="form-group">
                <label>ููุน ุงูุฒูุงุฑุฉ / ุงูููุงุญุธุงุช</label>
                <textarea id="visitNotes" class="form-control" rows="3" placeholder="ุงูุชุจ ุชูุงุตูู ุงูุฒูุงุฑุฉ ููุง..."></textarea>
            </div>
            <div class="grid-2">
                <button onclick="saveVisit()" class="action-btn" style="background:var(--success);">ุญูุธ</button>
                <button onclick="closeModal('visitModal')" class="action-btn" style="background:var(--danger);">ุฅูุบุงุก</button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    
    <script src="script.js"></script>
</body>
</html>
