<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุตุฉ ุงููุงุฆุฏ ุงูุชุนููููุฉ</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div class="header">
        <div class="header-content">
            <div>
                <h1 style="margin:0;">ููุตุฉ ุงููุงุฆุฏ โก</h1>
                <span id="userStatus" style="font-size:0.9rem; opacity:0.8;">ุฌุงุฑู ุงูุงุชุตุงู...</span>
            </div>
            <div class="header-actions">
                <div id="clockDisplay" class="clock-box">00:00</div>
                <button onclick="openSettings()" class="btn-icon">โ๏ธ</button>
            </div>
        </div>
    </div>

    <div class="main-container">
        
        <div id="page-schedule" class="page-section active">
            <div class="status-bar">
                <div style="flex:1">
                    <h2 id="currentPeriodLabel">...</h2>
                    <span id="simulationBadge" style="display:none;" class="badge-warn">ูุถุน ุงููุญุงูุงุฉ</span>
                </div>
                <div class="actions">
                    <button onclick="refreshSchedule()" class="btn-small">๐ ุชุญุฏูุซ</button>
                </div>
            </div>
            
            <div id="liveClassesContainer" class="classes-grid">
                <div class="empty-state">ูุง ุชูุฌุฏ ุญุตุต ูุดุทุฉ ุญุงููุงู</div>
            </div>
        </div>

        <div id="page-visits" class="page-section">
            <div class="section-header">
                <h2>ุณุฌู ุงูุฒูุงุฑุงุช ุงูุฅุดุฑุงููุฉ</h2>
                <button onclick="startNewVisit()" class="btn-primary">+ ุฒูุงุฑุฉ ุฌุฏูุฏุฉ</button>
            </div>
            <div id="visitsLogContainer" class="visits-list">
                </div>
        </div>

        <div id="page-teachers" class="page-section">
            <div class="section-header">
                <h2>ูุงุฆูุฉ ุงููุนูููู</h2>
                <input type="text" id="searchTeacher" placeholder="ุจุญุซ..." onkeyup="renderTeachers()">
            </div>
            <div id="teachersListContainer" class="teachers-grid">
                </div>
        </div>

    </div>

    <div class="bottom-nav">
        <button class="nav-item active" onclick="showPage('schedule')">๐ ุงูุญุตุต</button>
        <button class="nav-item" onclick="showPage('visits')">๐๏ธ ุงูุฒูุงุฑุงุช</button>
        <button class="nav-item" onclick="showPage('teachers')">๐จโ๐ซ ุงููุนูููู</button>
    </div>

    <div id="visitModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>ุฒูุงุฑุฉ ุฅุดุฑุงููุฉ ุฌุฏูุฏุฉ</h3>
                <button onclick="closeModal('visitModal')" class="close-btn">&times;</button>
            </div>
            <div class="visit-form">
                <div class="visit-meta-box">
                    <div class="form-group">
                        <label>ุงููุนูู:</label>
                        <input type="text" id="vTeacher" readonly>
                    </div>
                    <div class="form-group">
                        <label>ุงููุงุฏุฉ:</label>
                        <input type="text" id="vSubject" readonly>
                    </div>
                    <div class="form-group">
                        <label>ุงูุตู:</label>
                        <input type="text" id="vClass" readonly>
                    </div>
                    <div class="form-group" style="grid-column: 1/-1;">
                        <label>ุนููุงู ุงูุฏุฑุณ:</label>
                        <input type="text" id="vLessonTitle" placeholder="ุงูุชุจ ุนููุงู ุงูุฏุฑุณ ููุง...">
                    </div>
                </div>

                <div id="criteriaList" class="criteria-container"></div>

                <div class="form-group">
                    <label>ููุงุญุธุงุช ุนุงูุฉ ูุชูุตูุงุช ุฅุถุงููุฉ:</label>
                    <textarea id="vGeneralNotes" rows="3"></textarea>
                </div>

                <div class="modal-footer">
                    <button onclick="saveVisit()" class="btn-primary">ุญูุธ ูุฅุตุฏุงุฑ ุงูุชูุฑูุฑ ๐จ๏ธ</button>
                </div>
            </div>
        </div>
    </div>

    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <h3>โ๏ธ ุงูุฅุนุฏุงุฏุงุช</h3>
            
            <div class="setting-group">
                <label>1. ุฌุฏูู ุงูุญุตุต (XML)</label>
                <input type="file" id="xmlInput" accept=".xml" onchange="handleXML(this)">
            </div>

            <div class="setting-group">
                <label>2. ูุนุงููุฑ ุงูุฒูุงุฑุฉ (JSON)</label>
                <input type="file" id="jsonInput" accept=".json" onchange="handleCriteria(this)">
            </div>

            <div class="setting-group">
                <label>3. ุจูุงูุงุช ุงููุนูููู (Excel)</label>
                <div class="btn-group">
                    <button onclick="exportTeachersExcel()" class="btn-outline">ุชูุฒูู ุงููุงุฆูุฉ</button>
                    <button onclick="document.getElementById('excelInput').click()" class="btn-outline">ุฑูุน (ูุน ุงูููุงุชู)</button>
                    <input type="file" id="excelInput" hidden onchange="handlePhoneImport(this)">
                </div>
            </div>

            <div class="setting-group" style="background:#fff7ed; padding:10px; border-radius:8px;">
                <label>๐ฒ ูุญุงูุงุฉ ุงูููุช</label>
                <div style="display:flex; gap:10px;">
                    <select id="simDay">
                        <option value="1">ุงูุฃุญุฏ</option>
                        <option value="2">ุงูุงุซููู</option>
                        <option value="3">ุงูุซูุงุซุงุก</option>
                        <option value="4">ุงูุฃุฑุจุนุงุก</option>
                        <option value="5">ุงูุฎููุณ</option>
                    </select>
                    <input type="time" id="simTime">
                    <button onclick="toggleSim()" class="btn-small">ุชูุนูู</button>
                </div>
            </div>

            <button onclick="closeModal('settingsModal')" class="btn-full">ุฅุบูุงู</button>
        </div>
    </div>

    <script type="module" src="firebase-config.js"></script>
    <script type="module" src="firebase-service.js"></script>
    <script type="module" src="firebase-ui.js"></script>
    <script src="script.js"></script>
</body>
</html>
